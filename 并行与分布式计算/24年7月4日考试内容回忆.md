# 选择题

1. 片上缓存、主存、SSD固态硬盘的访问延迟级别分别是多少？ns、ns、us
2. 降低 cache 的 penalty、miss rate、hit time 的措施（背熟）
3. TLP级别四个图对应的模式（细粒度、粗粒度、器件一半划分、超线程）

# 简答题

## 1. Iron 铁律 $t=N\times CPI\div f$ ，问 RISC 和 CISC 架构对三个因子的影响

应该是 RISC 精简指令集通过提升频率，降低 CPI 提高吞吐率降低程序运行时间；CISC 通过降低程序的指令数量 N 来降低程序运行时间

## 2. 1000 个并行工作节点，若需要效率大于 70% 则程序的不可并行部分占比最多多少（效率=加速比/处理器数量）

## 3. Java 的 JIT 即时编译统计热点指令块的意义是什么？

# 代码分析题

## 1. 给定一段简单的 MPI 程序，问哪里可能出现问题

两个进程 send/recv 的顺序是一样的，有些 MPI 实现是阻塞调用，因此顺序一样的话会造成死锁，需要根据 MPI_RANK 进入不同的 `if-else` 分支使用相反的 send/recv 顺序

# 计算分析题

## 1. KNL 处理器有 72 个核心，布局在 $6\times 6$ 的二维网格上，每个节点包含两个 核心，问

### （1）KNL 核心的缓存一致性应该使用侦听协议还是目录协议？
### （2）最远的两个核心跳数是多少？

## 2. 举例一些 MapReduce 的各个阶段的优化方法

## 3. 给定一小段汇编代码

### （1）哪些指令之间可能出现 RAW 冲突？
### （2）该段指令的预估 CPI 是多少？
### （3）调换哪两条指令可以优化代码执行周期数？以及优化后 CPI 估计是多少？

给的五阶段流水线图 branch 分支预测模块提前到第一周期了。

## 4. 给定下列访问代码，问不同 cache 的缺失次数、缺失率、主存平均访问时间

```c
for (int i = 1; i < 16; ++i)
{
	int x = A[0][i-1];
	int y = A[i][i];
	A[i][i] = x + y;
}
```

其中 A 是 $1024\times 1024$ 的 32 位整型二维数组，数组起始地址是 64 字节对齐的（64 字节的整数倍，主存以字节寻址）。

### （1）cache 大小 4KB，block 大小 64 字节，使用直接映射，则执行完这段代码缓存缺失次数（），缓存的缺失率（），平均主存访问时间（），给出简要计算步骤。

### （2）cache 大小 8KB，使用二路组相联映射，block 64 字节，则执行完这段代码缓存缺失次数（），缓存的缺失率（），平均主存访问时间（），给出简要计算步骤。


## 5. 给定一段包含三个分支指令的循环代码如下

```c
#define N 100000
int a[N];
int s;
int i = 0;
do {
	if (a[i] < 0) s += a[i]; // branch 1
	if (a[i] > 2) s += a[i] * 2; // branch 2
	i++
} while (i < N) // branch 3
```

其中 `a` 已经初始化为 $[-100,\ 99]$ 的随机整数。三个分支各自有一个 1-bit 的分支预测器

### （1）三个分支预测语句的失误率是多少？
### （2）除了上述 3 条分支指令，还有额外 8 条其他指令，指令理想 CPI = 1，预测失败导致 4 周期阻塞，则该段程序预计的 CPI 是多少？

### （3）若还有一个额外的全局分支预测器，与每个分支的局部历史预测器一起使用，采用 tournament predictor 方案，则此时 CPI 预估是多少？

## 6. 给定 PPT 并行程序设计引论中的完全二叉树图，四层。

### （1）求该任务的关键路径、总工作量、最大并发度、加速比
### （2）若处理器数量位 m=8、m=2 此时该任务的加速比和效率是多少（效率就是前面简答题的定义）？
### （3）若任务图不止 4 层，而是 N 层并且处理器数量随着层数 N 的增加也设定为 N ，则随着 N 的增长任务图的效率提高还是降低？简述理由。